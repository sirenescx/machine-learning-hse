## Машинное Обучение | ДЗ1

### Что было сделано?

#### DS часть ([код](https://github.com/sirenescx/ml_hw_1/blob/master/notebooks/HW1_Regression_with_inference.ipynb))

 - предобработка и очистка данных по условию задания
 - обучение моделей и подбор гиперпараметров по условию задания
 - написан код для продакшен метрики
 - модель сохранена в формате `.pickle`
 - дополнительно: 
   - посчитаны статистики таргета (среднее, минимальное и максимальное значения, квантили)
   - нарисован боксплот с выбросами
   - изучена зависимость средней стоимости автомобиля от значений категориальных переменных
   - использован `CatBoostEncoder` (target encoding) для кодирования категориальных переменных, кроме `seats`
   - добавлены полиномиальные фичи

**Результаты:** лучшая модель на тестовой выборке дает `R^2 score = 0.8473638652284115`, `business_metrics = 0.294`

#### FastApi часть ([код](https://github.com/sirenescx/ml_hw_1/blob/master/api/api.py))
- написан класс с пайплайном ([код](https://github.com/sirenescx/ml_hw_1/blob/master/api/preprocessing_pipeline/pipeline.py)) для предобработки, очистки, кодирования, скейлинга и etc данных (из исходного файла получаем то, что можно скормить модели)
- реализовано api c двумя методами:
  - `predict_item`, получающим на вход json с одним объектом и возвращающим одно вещественное число – предсказание модели
  - `predict_items`, получающим на вход csv файл с одним или несколькими объектами и возвращающим csv файл, содержащий признаковое описание объектов и предсказания для каждого из них

**Результаты:**
![demo](pictures/demo.png)

**Вопросы:** в исходном файле метод `predict_items` получает на вход `List[Item]` и возвращает `List[float]`, с описанием не сходится, сделала как в описании

#### Что дало буст в качестве?
Полиномиальные фичи

#### Что не получилось/стоило сделать?

 - не получилось нормально обработать `torque` – где-то вообще нет единиц измерения, поэтому непонятно, где-то в `max_torque_rpm` интервал значений, что там брать, среднее?  Код написала, но в общем проще было дропнуть...
 - можно было побольше заняться Feature Engineeringом и может быть попробовать еще модели
